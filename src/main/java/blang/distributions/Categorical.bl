package blang.distributions

import blang.core.IntVar
import static java.lang.Math.log

import blang.types.Simplex

model Categorical {
  
  random IntVar realization
  
  param Simplex probabilities
  
  laws {
    
    logf(probabilities, realization)  {
      log(probabilities.get(realization))
    }
    
    indicator(probabilities, realization)  {
      realization >= 0 && realization < probabilities.nEntries
    }
    
    probabilities ~ new blang.core.ConstrainedFactor() 
  }
}